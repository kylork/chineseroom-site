<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Chinese Room</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css">
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/chat.css">
    <link rel="stylesheet" href="css/responsive.css">
</head>
<body>
    <div class="app-container">
        <header class="header">
            <a href="https://github.com/kylork/chineseroom-site" target="_blank" class="logo">Chinese Room</a>
            <div class="header-controls">
                <button id="playPauseBtn" class="play-pause-btn" title="Start conversation">‚ñ∂</button>
                <div class="header-divider"></div>
                <button class="font-size-btn" id="copyConversationBtn" title="Copy conversation to clipboard">‚ùê</button>
                <div class="font-size-controls">
                    <button class="font-size-btn" id="fontSizeDown" title="Decrease font size">A‚Åª</button>
                    <button class="font-size-btn" id="fontSizeUp" title="Increase font size">A‚Å∫</button>
                </div>
                <button class="fullscreen-btn" id="fullscreenBtn" title="Toggle fullscreen">‚õ∂</button>
                <button class="btn btn-secondary" id="toggleSidebarBtn">‚öôÔ∏è</button>
            </div>
        </header>

        <main class="main-content">
            <aside class="sidebar" id="sidebar">
                <!-- API Configuration -->
                <div class="settings-section" id="apiSection">
                    <div class="settings-header" data-section="apiSection">
                        <h3 class="settings-title settings-title-muted">API Configuration</h3>
                        <span class="collapse-icon">‚ñº</span>
                    </div>
                    <div class="settings-content">
                        <div class="form-group">
                            <label class="form-label">OpenRouter API Key</label>
                            <input type="password" class="form-input" id="apiKey" placeholder="sk-or-...">
                            <div class="form-row" style="margin-top: var(--space-xs);">
                                <button class="btn btn-secondary" id="saveApiKeyBtn" style="font-size: var(--text-xs);">Save</button>
                                <button class="btn btn-secondary" id="clearApiKeyBtn" style="font-size: var(--text-xs);">Clear</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Session Settings -->
                <div class="settings-section" id="chatSettingsSection">
                    <div class="settings-header" data-section="chatSettingsSection">
                        <h3 class="settings-title settings-title-muted">Session</h3>
                        <span class="collapse-icon">‚ñº</span>
                    </div>
                    <div class="settings-content">
                        <div class="form-row" style="margin-bottom: var(--space-md);">
                            <div class="form-group">
                                <label class="form-label">Max Exchanges</label>
                                <select class="form-select" id="maxExchanges">
                                    <option value="10">10</option>
                                    <option value="20">20</option>
                                    <option value="30">30</option>
                                    <option value="40">40</option>
                                    <option value="50">50</option>
                                    <option value="60">60</option>
                                    <option value="100">100</option>
                                    <option value="unlimited">Unlimited</option>
                                    <option value="custom">Custom</option>
                                </select>
                            </div>
                            <div class="form-group hidden" id="customExchangeGroup">
                                <label class="form-label">Custom</label>
                                <input type="number" class="form-input" id="customExchanges" min="1" max="1000000" value="1">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label checkbox-label">
                                <input type="checkbox" id="allowMutualTermination">
                                Bots can mutually terminate session with [END]
                            </label>
                        </div>
                        <div class="form-group">
                            <label class="form-label checkbox-label">
                                <input type="checkbox" id="enableDisplayNames">
                                Enable bot Display Name fields
                            </label>
                        </div>
                        <div class="form-row three-col">
                            <button class="btn btn-secondary" id="clearChatBtn" style="font-size: var(--text-xs);">üóëÔ∏è Clear</button>
                            <button class="btn btn-secondary" id="resetSettingsBtn" style="font-size: var(--text-xs);">‚Ü∫ Reset</button>
                            <button class="btn" id="saveSettingsBtn" style="font-size: var(--text-xs);">üíæ Save</button>
                        </div>
                    </div>
                </div>

                <!-- Bot 1 -->
                <div class="settings-section" id="bot1Section">
                    <div class="settings-header" data-section="bot1Section">
                        <div class="bot-header">
                            <span class="bot-indicator bot1"></span>
                            <h3 class="settings-title">Bot 1</h3>
                        </div>
                        <span class="collapse-icon">‚ñº</span>
                    </div>
                    <div class="settings-content">
                        <div class="form-group">
                            <label class="form-label">Model</label>
                            <div class="custom-select-wrapper">
                                <div class="custom-select-trigger" id="bot1ModelTrigger">
                                    <span id="bot1ModelDisplay">Loading models...</span>
                                    <span class="custom-select-arrow">‚ñº</span>
                                </div>
                                <div class="custom-select-dropdown" id="bot1ModelDropdown">
                                    <input type="text" class="custom-select-search" id="bot1ModelSearch" placeholder="Search models...">
                                    <div class="custom-select-options" id="bot1ModelOptions"></div>
                                </div>
                            </div>
                            <input type="hidden" id="bot1Model" value="">
                        </div>
                        <div class="form-group">
                            <label class="form-label checkbox-label">
                                <input type="checkbox" id="bot1WebSearch">
                                Enable web search
                            </label>
                        </div>
                        <div class="form-group hidden" id="bot1NameGroup">
                            <label class="form-label">Display Name</label>
                            <input type="text" class="form-input" id="bot1Name" placeholder="Auto-generated from model">
                        </div>

                        <!-- Parameters Sub-section -->
                        <div class="settings-subsection">
                            <div class="subsection-header" data-subsection="bot1Params">
                                <span class="subsection-title">Parameters</span>
                                <span class="collapse-icon" id="bot1ParamsIcon">‚ñº</span>
                            </div>
                            <div class="subsection-content" id="bot1Params">
                                <div class="form-group">
                                    <label class="form-label">Max Output Tokens: <span id="bot1TokenValue">16000</span></label>
                                    <div class="slider-container">
                                        <input type="range" class="slider" id="bot1MaxTokens" min="100" max="16384" value="16000" step="50">
                                        <span class="slider-value editable-value" id="bot1TokenDisplay" contenteditable="true">16000</span>
                                    </div>
                                </div>
                                <div class="form-group" id="bot1TemperatureGroup">
                                    <label class="form-label">Temperature: <span id="bot1TempValue">1</span></label>
                                    <div class="slider-container">
                                        <input type="range" class="slider" id="bot1Temperature" min="0" max="2" value="1" step="0.01">
                                        <span class="slider-value editable-value" id="bot1TempDisplay" contenteditable="true">1</span>
                                    </div>
                                </div>
                                <div class="form-group" id="bot1TopPGroup">
                                    <label class="form-label">Top P: <span id="bot1TopPValue">1.0</span></label>
                                    <div class="slider-container">
                                        <input type="range" class="slider" id="bot1TopP" min="0" max="1" value="1.0" step="0.01">
                                        <span class="slider-value editable-value" id="bot1TopPDisplay" contenteditable="true">1.0</span>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label class="form-label">Reasoning</label>
                                        <select class="form-select" id="bot1Reasoning">
                                            <option value="low">Low</option>
                                            <option value="medium" selected>Medium</option>
                                            <option value="high">High</option>
                                        </select>
                                    </div>
                                    <div class="form-group" id="bot1VerbosityGroup">
                                        <label class="form-label">Verbosity</label>
                                        <select class="form-select" id="bot1Verbosity">
                                            <option value="low">Low</option>
                                            <option value="medium" selected>Medium</option>
                                            <option value="high">High</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Prompts Sub-section -->
                        <div class="settings-subsection">
                            <div class="subsection-header" data-subsection="bot1Prompts">
                                <span class="subsection-title">Prompts</span>
                                <span class="collapse-icon" id="bot1PromptsIcon">‚ñº</span>
                            </div>
                            <div class="subsection-content" id="bot1Prompts">
                                <div class="form-group">
                                    <label class="form-label">System Prompt</label>
                                    <textarea class="form-textarea" id="bot1SystemPrompt" style="height: 80px; min-height: 50px;" placeholder="Highest priority instructions..."></textarea>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Custom Instructions</label>
                                    <textarea class="form-textarea" id="bot1Instructions" style="height: 100px; min-height: 50px;" placeholder="Developer-level instructions..."></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bot 2 -->
                <div class="settings-section" id="bot2Section">
                    <div class="settings-header" data-section="bot2Section">
                        <div class="bot-header">
                            <span class="bot-indicator bot2"></span>
                            <h3 class="settings-title">Bot 2</h3>
                        </div>
                        <span class="collapse-icon">‚ñº</span>
                    </div>
                    <div class="settings-content">
                        <div class="form-group">
                            <label class="form-label">Model</label>
                            <div class="custom-select-wrapper">
                                <div class="custom-select-trigger" id="bot2ModelTrigger">
                                    <span id="bot2ModelDisplay">Loading models...</span>
                                    <span class="custom-select-arrow">‚ñº</span>
                                </div>
                                <div class="custom-select-dropdown" id="bot2ModelDropdown">
                                    <input type="text" class="custom-select-search" id="bot2ModelSearch" placeholder="Search models...">
                                    <div class="custom-select-options" id="bot2ModelOptions"></div>
                                </div>
                            </div>
                            <input type="hidden" id="bot2Model" value="">
                        </div>
                        <div class="form-group">
                            <label class="form-label checkbox-label">
                                <input type="checkbox" id="bot2WebSearch">
                                Enable web search
                            </label>
                        </div>
                        <div class="form-group hidden" id="bot2NameGroup">
                            <label class="form-label">Display Name</label>
                            <input type="text" class="form-input" id="bot2Name" placeholder="Auto-generated from model">
                        </div>

                        <!-- Parameters Sub-section -->
                        <div class="settings-subsection">
                            <div class="subsection-header" data-subsection="bot2Params">
                                <span class="subsection-title">Parameters</span>
                                <span class="collapse-icon" id="bot2ParamsIcon">‚ñº</span>
                            </div>
                            <div class="subsection-content" id="bot2Params">
                                <div class="form-group">
                                    <label class="form-label">Max Output Tokens: <span id="bot2TokenValue">16000</span></label>
                                    <div class="slider-container">
                                        <input type="range" class="slider" id="bot2MaxTokens" min="100" max="16384" value="16000" step="50">
                                        <span class="slider-value editable-value" id="bot2TokenDisplay" contenteditable="true">16000</span>
                                    </div>
                                </div>
                                <div class="form-group" id="bot2TemperatureGroup">
                                    <label class="form-label">Temperature: <span id="bot2TempValue">1</span></label>
                                    <div class="slider-container">
                                        <input type="range" class="slider" id="bot2Temperature" min="0" max="2" value="1" step="0.01">
                                        <span class="slider-value editable-value" id="bot2TempDisplay" contenteditable="true">1</span>
                                    </div>
                                </div>
                                <div class="form-group" id="bot2TopPGroup">
                                    <label class="form-label">Top P: <span id="bot2TopPValue">1.0</span></label>
                                    <div class="slider-container">
                                        <input type="range" class="slider" id="bot2TopP" min="0" max="1" value="1.0" step="0.01">
                                        <span class="slider-value editable-value" id="bot2TopPDisplay" contenteditable="true">1.0</span>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label class="form-label">Reasoning</label>
                                        <select class="form-select" id="bot2Reasoning">
                                            <option value="low">Low</option>
                                            <option value="medium" selected>Medium</option>
                                            <option value="high">High</option>
                                        </select>
                                    </div>
                                    <div class="form-group" id="bot2VerbosityGroup">
                                        <label class="form-label">Verbosity</label>
                                        <select class="form-select" id="bot2Verbosity">
                                            <option value="low">Low</option>
                                            <option value="medium" selected>Medium</option>
                                            <option value="high">High</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Prompts Sub-section -->
                        <div class="settings-subsection">
                            <div class="subsection-header" data-subsection="bot2Prompts">
                                <span class="subsection-title">Prompts</span>
                                <span class="collapse-icon" id="bot2PromptsIcon">‚ñº</span>
                            </div>
                            <div class="subsection-content" id="bot2Prompts">
                                <div class="form-group">
                                    <label class="form-label">System Prompt</label>
                                    <textarea class="form-textarea" id="bot2SystemPrompt" style="height: 80px; min-height: 50px;" placeholder="Highest priority instructions..."></textarea>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Custom Instructions</label>
                                    <textarea class="form-textarea" id="bot2Instructions" style="height: 100px; min-height: 50px;" placeholder="Developer-level instructions..."></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </aside>

            <div class="sidebar-resizer" id="sidebarResizer" aria-hidden="true"></div>

            <section class="chat-area">
                <div class="chat-messages" id="chatMessages" role="log" aria-live="polite" aria-label="Chat conversation">
                    <!-- Messages will be added here -->
                </div>

                <button class="scroll-to-latest hidden" id="scrollToLatestBtn">Jump to latest ‚Üì</button>

                <div class="chat-input-area">
                    <div class="input-group">
                        <textarea class="chat-input" id="messageInput" placeholder="Enter topic or join the conversation..." rows="1"></textarea>
                        <button class="send-btn btn" id="sendBtn">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </section>
        </main>

        <div class="status-bar">
            <span id="statusText">Ready</span>
            <span id="messageCount">Messages: 0</span>
        </div>
    </div>

    <!-- Sidebar overlay for mobile -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <!-- Toast notifications -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- External libraries -->
    <script src="https://cdn.jsdelivr.net/npm/marked@12.0.2/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js"></script>

    <!-- App modules -->
    <script src="js/config.js"></script>
    <script src="js/state.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/api.js"></script>
    <script src="js/ui/messages.js"></script>
    <script src="js/ui/sidebar.js"></script>
    <script src="js/ui/chatInput.js"></script>
    <script src="js/ui/customSelect.js"></script>
    <script src="js/conversation.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
